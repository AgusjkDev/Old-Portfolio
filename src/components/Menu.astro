---
import Navbar from "./Navbar.astro";
import ResumeButton from "./ResumeButton.astro";
---

<aside
    id="menu"
    class="fixed inset-0 z-[2] flex translate-x-[100vw] flex-col items-center justify-around bg-slate-800/[0.975] py-20 opacity-0 transition-all duration-500 md:hidden"
>
    <button id="closeMenu" aria-label="Cerrar Menu">
        <img alt="Cerrar Menu" src="/imgs/close.svg" decoding="async" fetchpriority="high" />
    </button>

    <Navbar />

    <ResumeButton />
</aside>

<script type="module">
    const breakpoint = 768;
    const mediaQuery = window.matchMedia(`(min-width: ${breakpoint}px)`);
    const menu = document.querySelector("#menu");
    const elems = [
        document.querySelector("#menuButton"),
        document.querySelector("#closeMenu"),
        ...document.querySelectorAll(".menu-button"),
    ];

    function toggleMenu() {
        menu.classList.toggle("opacity-0");
        menu.classList.toggle("translate-x-[100vw]");
        document.body.classList.toggle("overflow-y-hidden");
    }

    function addListeners() {
        elems.forEach(elem => elem.addEventListener("click", toggleMenu));
    }

    function removeEventListeners() {
        elems.forEach(elem => elem.removeEventListener("click", toggleMenu));
    }

    if (document.documentElement.clientWidth < breakpoint) addListeners();

    mediaQuery.addEventListener("change", e =>
        e.matches ? removeEventListeners() : addListeners()
    );
</script>
